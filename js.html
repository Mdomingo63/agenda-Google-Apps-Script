<script>

   function  crearTablaContactos(){
          
        let tabla = document.getElementById("tablaContactos");
        if(tabla) tabla.remove();

    google.script.run.withSuccessHandler(

         function(obj){
          
           tabla = document.createElement("table");
           tabla.id = 'tablaContactos';
           let tablaHeader = document.createElement("thead");
           let tablaBody = document.createElement("tbody");

            // SOLUCION UN BUCLE FOR

            // ESTE PRIMER BUCLE RECORRE LA CABECERA LA TABLA POR ES OBJ[0]
             
             let primeraFila = document.createElement('tr');

            for(let i = 0; i < obj[0].length; i++){
              
                    let celda = document.createElement('td');
                    celda.textContent = obj[0][i];
                    primeraFila.appendChild(celda);
 
            }

                    tablaHeader.appendChild(primeraFila);
                    tabla.appendChild(tablaHeader);

              // ESTE BUCLE RECORRE EL CUERPO DE LA TABLA POR OBJ[i][j], i es la fila y j la celda
            for(let i = 1; i< obj.length; i++){
              
                   let fila = document.createElement('tr');
                   for(let j = 0; j < obj[i].length; j++){
                      
                    let celda = document.createElement('td');
                    celda.textContent = obj[i][j];
                    fila.appendChild(celda);

                   }
                   
                    tablaBody.appendChild(fila);
                 
            }



             // SOLUCION CON EL BUCLE FOREACH

           /* Array.from(obj).forEach((filaActual, i) =>{

                let fila = document.createElement("tr");
                filaActual.forEach(celdaActual =>{
                   
                      let celda = document.createElement("td");
                      celda.textContent = celdaActual;
                      fila.appendChild(celda);
                });

                 if(i == 0){
                    tablaHeader.appendChild(fila);
                    tabla.appendChild(tablaHeader);
                 }else{
                    tablaBody.appendChild(fila);
                 }
                
           });
 */
             //AGREGAMOS CLASES DE BOOTSTRAP A LA CABECERA
        
             tablaHeader.classList.add('table-dark');

           // AGREGAMOS EL CUERPO A  LA TABLA
              tabla.appendChild(tablaBody);

            // AGREGAMOS ESTILOS DE BOOTSRAP A LA TABLA

              tabla.classList.add("table", "table-striped","border", "border-3");

              //  AGREGAMOS LA TABLA AL DIV CON ID divContactos
              document.getElementById("divContactos").appendChild(tabla);

         }

    ).obtenerContactos();

   }
</script>